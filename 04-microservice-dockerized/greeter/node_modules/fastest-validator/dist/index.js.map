{"version":3,"file":"index.js","sources":["../lib/helpers/flatten.js","../lib/helpers/deep-extend.js","../lib/messages.js","../lib/rules/any.js","../lib/rules/array.js","../lib/rules/boolean.js","../lib/rules/custom.js","../lib/rules/date.js","../lib/rules/email.js","../lib/rules/enum.js","../lib/rules/forbidden.js","../lib/rules/function.js","../lib/rules/number.js","../lib/rules/object.js","../lib/rules/string.js","../lib/rules/url.js","../lib/validator.js","../index.js"],"sourcesContent":["\"use strict\";\r\n\r\n/**\r\n * Flatten an array\r\n * @param {Array} array\r\n * @param {Array} target\r\n * @returns Array flattened array\r\n */\r\nfunction flatten(array, target) {\r\n\tconst result = target || [];\r\n\r\n\tfor (let i = 0; i < array.length; ++i) {\r\n\t\tif (Array.isArray(array[i])) {\r\n\t\t\tflatten(array[i], result);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tresult.push(array[i]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nmodule.exports = flatten;\r\n","\"use strict\";\r\n\r\nfunction deepExtend(destination, source) {\r\n\tfor (let property in source) {\r\n\t\tif (typeof source[property] === \"object\" &&\r\n\t\t\tsource[property] !== null) {\r\n\t\t\tdestination[property] = destination[property] || {};\r\n\t\t\tdeepExtend(destination[property], source[property]);\r\n\t\t} else {\r\n\t\t\tdestination[property] = source[property];\r\n\t\t}\r\n\t}\r\n\treturn destination;\r\n}\r\n\r\nmodule.exports = deepExtend;","\"use strict\";\r\n\r\nmodule.exports = {\r\n\trequired: \"The '{field}' field is required!\",\r\n\r\n\tstring: \"The '{field}' field must be a string!\",\r\n\tstringEmpty: \"The '{field}' field must not be empty!\",\r\n\tstringMin: \"The '{field}' field length must be greater than or equal to {expected} characters long!\",\r\n\tstringMax: \"The '{field}' field length must be less than or equal to {expected} characters long!\",\r\n\tstringLength: \"The '{field}' field length must be {expected} characters long!\",\r\n\tstringPattern: \"The '{field}' field fails to match the required pattern!\",\r\n\tstringContains: \"The '{field}' field must contain the '{expected}' text!\",\r\n\tstringEnum: \"The '{field}' field does not match any of the allowed values!\",\r\n\r\n\tnumber: \"The '{field}' field must be a number!\",\r\n\tnumberMin: \"The '{field}' field must be greater than or equal to {expected}!\",\r\n\tnumberMax: \"The '{field}' field must be less than or equal to {expected}!\",\r\n\tnumberEqual: \"The '{field}' field must be equal with {expected}!\",\r\n\tnumberNotEqual: \"The '{field}' field can't be equal with {expected}!\",\r\n\tnumberInteger: \"The '{field}' field must be an integer!\",\r\n\tnumberPositive: \"The '{field}' field must be a positive number!\",\r\n\tnumberNegative: \"The '{field}' field must be a negative number!\",\r\n\t\r\n\tarray: \"The '{field}' field must be an array!\",\r\n\tarrayEmpty: \"The '{field}' field must not be an empty array!\",\r\n\tarrayMin: \"The '{field}' field must contain at least {expected} items!\",\r\n\tarrayMax: \"The '{field}' field must contain less than or equal to {expected} items!\",\r\n\tarrayLength: \"The '{field}' field must contain {expected} items!\",\r\n\tarrayContains: \"The '{field}' field must contain the '{expected}' item!\",\r\n\tarrayEnum: \"The '{field} field value '{expected}' does not match any of the allowed values!\",\r\n\r\n\tboolean: \"The '{field}' field must be a boolean!\",\r\n\r\n\tfunction: \"The '{field}' field must be a function!\",\r\n\r\n\tdate: \"The '{field}' field must be a Date!\",\r\n\tdateMin: \"The '{field}' field must be greater than or equal to {expected}!\",\r\n\tdateMax: \"The '{field}' field must be less than or equal to {expected}!\",\r\n\r\n\tforbidden: \"The '{field}' field is forbidden!\",\r\n\t\r\n\temail: \"The '{field}' field must be a valid e-mail!\",\r\n\r\n\tenumValue: \"The '{field} field value '{expected}' does not match any of the allowed values!\",\r\n};","\"use strict\";\r\n\r\nmodule.exports = function checkAny() {\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nmodule.exports = function checkArray(value, schema) {\r\n\tif (!Array.isArray(value)) {\r\n\t\treturn this.makeError(\"array\");\r\n\t}\r\n\r\n\tconst arrLength = value.length;\r\n\r\n\tif (schema.empty === false && arrLength === 0) {\r\n\t\treturn this.makeError(\"arrayEmpty\");\r\n\t}\r\n\r\n\tif (schema.min != null && arrLength < schema.min) {\r\n\t\treturn this.makeError(\"arrayMin\", schema.min, arrLength);\r\n\t}\r\n\r\n\tif (schema.max != null && arrLength > schema.max) {\r\n\t\treturn this.makeError(\"arrayMax\", schema.max, arrLength);\r\n\t}\r\n\r\n\t// Check fix length\r\n\tif (schema.length != null && arrLength !== schema.length) {\r\n\t\treturn this.makeError(\"arrayLength\", schema.length, arrLength);\r\n\t}\t\r\n\r\n\tif (schema.contains != null && value.indexOf(schema.contains) === -1) {\r\n\t\treturn this.makeError(\"arrayContains\", schema.contains);\r\n\t}\t\r\n\r\n\tif (schema.enum != null) {\r\n\t\tfor (let i = 0; i < value.length; i++) {\r\n\t\t\tif (schema.enum.indexOf(value[i]) === -1) {\r\n\t\t\t\treturn this.makeError(\"arrayEnum\", value[i], schema.enum);\r\n\t\t\t}\r\n\t\t}\r\n\t}\t\r\n\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nmodule.exports = function checkBoolean(value, schema) {\r\n\tif (schema.convert === true && typeof value !== \"boolean\") {\r\n\t\tif (\r\n\t\t\tvalue === 1\r\n\t\t|| value === 0\r\n\t\t|| value === \"true\"\r\n\t\t|| value === \"false\"\r\n\t\t|| value === \"1\"\r\n\t\t|| value === \"0\"\r\n\t\t|| value === \"on\"\r\n\t\t|| value === \"off\"\r\n\t\t) \r\n\t\t\treturn true;\r\n\t}\r\n\t\r\n\tif (typeof value !== \"boolean\") {\r\n\t\treturn this.makeError(\"boolean\");\r\n\t}\r\n\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nmodule.exports = function customCheck(value, schema) {\r\n\treturn schema.check.call(this, value, schema);\r\n};","\"use strict\";\r\n\r\nmodule.exports = function checkDate(value, schema) {\r\n\tif (schema.convert === true && !(value instanceof Date)) {\r\n\t\tvalue = new Date(value);\r\n\t}\r\n\t\r\n\tif (!(value instanceof Date)) {\r\n\t\treturn this.makeError(\"date\");\r\n\t}\r\n\r\n\tif (isNaN(value.getTime())) {\r\n\t\treturn this.makeError(\"date\");\r\n\t}\r\n\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nconst PRECISE_PATTERN = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\nconst BASIC_PATTERN = /^\\S+@\\S+\\.\\S+$/;\r\n\r\nmodule.exports = function checkEmail(value, schema) {\r\n\tif (typeof value !== \"string\") {\r\n\t\treturn this.makeError(\"string\");\r\n\t}\r\n\r\n\tlet pattern;\r\n\tif (schema.mode == \"precise\")\r\n\t\tpattern = PRECISE_PATTERN;\r\n\telse\r\n\t\tpattern = BASIC_PATTERN;\r\n\t\r\n\tif (!pattern.test(value)) {\r\n\t\treturn this.makeError(\"email\");\r\n\t}\r\n\r\n\treturn true;\r\n};\r\n","\"use strict\";\r\n\r\nmodule.exports = function checkEnum(value, schema) {\r\n\r\n\tif (schema.values != null && schema.values.indexOf(value) === -1) {\r\n\t\treturn this.makeError(\"enumValue\", schema.values, value);\r\n\t}\r\n\r\n\treturn true;\r\n};\r\n","\"use strict\";\r\n\r\nmodule.exports = function checkForbidden(value) {\r\n\tif (value !== null && value !== undefined) {\r\n\t\treturn this.makeError(\"forbidden\");\r\n\t}\r\n\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nmodule.exports = function checkFunction(value) {\r\n\tif (typeof value !== \"function\") {\r\n\t\treturn this.makeError(\"function\");\r\n\t}\r\n\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nmodule.exports = function checkNumber(value, schema) {\r\n\tif (schema.convert === true && typeof value !== \"number\") {\r\n\t\tvalue = Number(value);\r\n\t}\r\n\r\n\tif (typeof value !== \"number\") {\r\n\t\treturn this.makeError(\"number\");\r\n\t}\r\n\r\n\tif (isNaN(value) || !isFinite(value)) {\r\n\t\treturn this.makeError(\"number\");\r\n\t}\r\n\r\n\tif (schema.min != null && value < schema.min) {\r\n\t\treturn this.makeError(\"numberMin\", schema.min, value);\r\n\t}\r\n\r\n\tif (schema.max != null && value > schema.max) {\r\n\t\treturn this.makeError(\"numberMax\", schema.max, value);\r\n\t}\r\n\r\n\t// Check fix value\r\n\tif (schema.equal != null && value !== schema.equal) {\r\n\t\treturn this.makeError(\"numberEqual\", schema.equal, value);\r\n\t}\t\r\n\r\n\t// Check not fix value\r\n\tif (schema.notEqual != null && value === schema.notEqual) {\r\n\t\treturn this.makeError(\"numberNotEqual\", schema.notEqual);\r\n\t}\t\r\n\r\n\t// Check integer\r\n\tif (schema.integer === true && value % 1 !== 0) {\r\n\t\treturn this.makeError(\"numberInteger\", value);\r\n\t}\t\r\n\r\n\t// Check positive\r\n\tif (schema.positive === true && value <= 0) {\r\n\t\treturn this.makeError(\"numberPositive\", value);\r\n\t}\t\r\n\r\n\t// Check negative\r\n\tif (schema.negative === true && value >= 0) {\r\n\t\treturn this.makeError(\"numberNegative\", value);\r\n\t}\r\n\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nmodule.exports = function checkObject(value) {\r\n\tif (typeof value !== \"object\" || value === null || Array.isArray(value)) {\r\n\t\treturn this.makeError(\"object\");\r\n\t}\r\n\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nmodule.exports = function checkString(value, schema) {\r\n\tif (typeof value !== \"string\") {\r\n\t\treturn this.makeError(\"string\");\r\n\t}\r\n\r\n\t/* TODO: charset\r\n\t \talpha: /^[a-zA-Z]+$/\r\n\t\talphaNum: /^[a-zA-Z0-9]+$/\r\n\t\talphaDash: /^[a-zA-Z0-9_\\-]+$/\r\n\r\n\t*/\r\n\r\n\tconst valueLength = value.length;\r\n\r\n\tif (schema.empty === false && valueLength === 0) {\r\n\t\treturn this.makeError(\"stringEmpty\");\r\n\t}\r\n\r\n\tif (schema.min != null && valueLength < schema.min) {\r\n\t\treturn this.makeError(\"stringMin\", schema.min, valueLength);\r\n\t}\r\n\r\n\tif (schema.max != null && valueLength > schema.max) {\r\n\t\treturn this.makeError(\"stringMax\", schema.max, valueLength);\r\n\t}\r\n\r\n\tif (schema.length != null && valueLength !== schema.length) {\r\n\t\treturn this.makeError(\"stringLength\", schema.length, valueLength);\r\n\t}\t\r\n\r\n\tif (schema.pattern != null && !schema.pattern.test(value)) {\r\n\t\treturn this.makeError(\"stringPattern\", schema.pattern );\r\n\t}\r\n\r\n\tif (schema.contains != null && value.indexOf(schema.contains) === -1) {\r\n\t\treturn this.makeError(\"stringContains\", schema.contains);\r\n\t}\t\r\n\r\n\tif (schema.enum != null && schema.enum.indexOf(value) === -1) {\r\n\t\treturn this.makeError(\"stringEnum\", schema.enum);\r\n\t}\r\n\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nconst PATTERN = /^https?:\\/\\/\\S+/;\r\n//const PATTERN = /^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$/i;\r\n//const PATTERN = /https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)/g;\r\n\r\nmodule.exports = function checkUrl(value) {\r\n\tif (typeof value !== \"string\") {\r\n\t\treturn this.makeError(\"string\");\r\n\t}\r\n\t\r\n\tif (!PATTERN.test(value)) {\r\n\t\treturn this.makeError(\"url\");\r\n\t}\r\n\r\n\treturn true;\r\n};","\"use strict\";\r\n\r\nconst flatten = require(\"./helpers/flatten\");\r\nconst deepExtend = require(\"./helpers/deep-extend\");\r\nconst defaultMessages = require(\"./messages\");\r\n\r\nfunction loadRules() {\r\n\treturn {\r\n\t\tany: require(\"./rules/any\"),\r\n\t\tarray: require(\"./rules/array\"),\r\n\t\tboolean: require(\"./rules/boolean\"),\r\n\t\tcustom: require(\"./rules/custom\"),\r\n\t\tdate: require(\"./rules/date\"),\r\n\t\temail: require(\"./rules/email\"),\r\n\t\tenum: require(\"./rules/enum\"),\r\n\t\tforbidden: require(\"./rules/forbidden\"),\r\n\t\tfunction: require(\"./rules/function\"),\r\n\t\tnumber: require(\"./rules/number\"),\r\n\t\tobject: require(\"./rules/object\"),\r\n\t\tstring: require(\"./rules/string\"),\r\n\t\turl: require(\"./rules/url\")\r\n\t};\r\n}\r\n\r\n// Quick regex to match most common unquoted JavaScript property names. Note the spec allows Unicode letters.\r\n// Unmatched property names will be quoted and validate slighly slower. https://www.ecma-international.org/ecma-262/5.1/#sec-7.6\r\nconst identifierRegex = /^[_$a-zA-Z][_$a-zA-Z0-9]*$/;\r\n\r\n// Regex to escape quoted property names for eval/new Function\r\nconst escapeEvalRegex = /[\"'\\\\\\n\\r\\u2028\\u2029]/g;\r\n\r\nfunction escapeEvalString(str) {\r\n\t// Based on https://github.com/joliss/js-string-escape\r\n\treturn str.replace(escapeEvalRegex, function (character) {\r\n\t\tswitch (character) {\r\n\t\t\tcase \"\\\"\":\r\n\t\t\tcase \"'\":\r\n\t\t\tcase \"\\\\\":\r\n\t\t\t\treturn \"\\\\\" + character;\r\n\t\t\t// Four possible LineTerminator characters need to be escaped:\r\n\t\t\tcase \"\\n\":\r\n\t\t\t\treturn \"\\\\n\";\r\n\t\t\tcase \"\\r\":\r\n\t\t\t\treturn \"\\\\r\";\r\n\t\t\tcase \"\\u2028\":\r\n\t\t\t\treturn \"\\\\u2028\";\r\n\t\t\tcase \"\\u2029\":\r\n\t\t\t\treturn \"\\\\u2029\";\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * Validator class constructor\r\n *\r\n * @param {Object} opts\r\n */\r\nfunction Validator(opts) {\r\n\tthis.opts = {\r\n\t\tmessages: defaultMessages\r\n\t};\r\n\r\n\tif (opts)\r\n\t\tdeepExtend(this.opts, opts);\r\n\r\n\tthis.messages = this.opts.messages;\r\n\r\n\t// Load rules\r\n\tthis.rules = loadRules();\r\n\tthis.cache = new Map();\r\n}\r\n\r\n/**\r\n * Validate an object by schema\r\n *\r\n * @param {Object} obj\r\n * @param {Object} schema\r\n */\r\nValidator.prototype.validate = function(obj, schema) {\r\n\tconst check = this.compile(schema);\r\n\treturn check(obj);\r\n};\r\n\r\n/**\r\n * Compile a schema\r\n *\r\n * @param {Object} schema\r\n * @throws {Error} Invalid schema\r\n */\r\nValidator.prototype.compile = function(schema) {\r\n\tconst self = this;\r\n\tif (Array.isArray(schema)) {\r\n\t\t// Multiple schemas\r\n\t\tif (schema.length == 0) {\r\n\t\t\tthrow new Error(\"If the schema is an Array, must contain at least one element!\");\r\n\t\t}\r\n\r\n\t\tconst rules = this.compileSchemaType(schema);\r\n\t\tthis.cache.clear();\r\n\t\treturn function(value) {\r\n\t\t\treturn self.checkSchemaType(value, rules, undefined, null);\r\n\t\t};\r\n\t} \r\n\r\n\tconst rule = this.compileSchemaObject(schema);\r\n\tthis.cache.clear();\r\n\treturn function(value) {\r\n\t\treturn self.checkSchemaObject(value, rule, undefined, null);\r\n\t};\r\n};\r\n\r\nValidator.prototype.compileSchemaObject = function(schemaObject) {\r\n\tif (schemaObject === null || typeof schemaObject !== \"object\" || Array.isArray(schemaObject)) {\r\n\t\tthrow new Error(\"Invalid schema!\");\r\n\t}\r\n\r\n\tlet compiledObject = this.cache.get(schemaObject);\r\n\tif (compiledObject) {\r\n\t\tcompiledObject.cycle = true;\r\n\t\treturn compiledObject;\r\n\t} else{\r\n\t\tcompiledObject = { cycle: false, properties: null, compiledObjectFunction: null, objectStack: [] };\r\n\t\tthis.cache.set(schemaObject, compiledObject);\r\n\t}\r\n\r\n\tcompiledObject.properties = Object.keys(schemaObject).map(name => {\r\n\t\tconst compiledType = this.compileSchemaType(schemaObject[name]);\r\n\t\treturn {name: name, compiledType: compiledType};\r\n\t});\r\n\r\n\tconst sourceCode = [];\r\n\tsourceCode.push(\"let res;\");\r\n\tsourceCode.push(\"let propertyPath;\");\r\n\tsourceCode.push(\"const errors = [];\");\r\n\tfor (let i = 0; i < compiledObject.properties.length; i++) {\r\n\t\tconst property = compiledObject.properties[i];\r\n\t\tconst name = escapeEvalString(property.name);\r\n\t\tconst propertyValueExpr = identifierRegex.test(name) ? `value.${name}` : `value[\"${name}\"]`;\r\n\r\n\t\tsourceCode.push(`propertyPath = (path !== undefined ? path + \".${name}\" : \"${name}\");`);\r\n\t\tif (Array.isArray(property.compiledType)) {\r\n\t\t\tsourceCode.push(`res = this.checkSchemaType(${propertyValueExpr}, properties[${i}].compiledType, propertyPath, value);`);\r\n\t\t} else {\r\n\t\t\tsourceCode.push(`res = this.checkSchemaRule(${propertyValueExpr}, properties[${i}].compiledType, propertyPath, value);`);\r\n\t\t}\r\n\t\tsourceCode.push(\"if (res !== true) {\");\r\n\t\tsourceCode.push(\"\\tthis.handleResult(errors, propertyPath, res);\");\r\n\t\tsourceCode.push(\"}\");\r\n\t}\r\n\r\n\tsourceCode.push(\"return errors.length === 0 ? true : errors;\");\r\n\r\n\tcompiledObject.compiledObjectFunction = new Function(\"value\", \"properties\", \"path\", \"parent\", sourceCode.join(\"\\n\"));\r\n\r\n\treturn compiledObject;\r\n};\r\n\r\nValidator.prototype.compileSchemaType = function(schemaType) {\r\n\tif (Array.isArray(schemaType)) {\r\n\t\t// Multiple rules, flatten to array of compiled SchemaRule\r\n\t\tconst rules = flatten(schemaType.map(r => this.compileSchemaType(r)));\r\n\t\tif (rules.length == 1) {\r\n\t\t\treturn rules[0];\r\n\t\t}\r\n\r\n\t\treturn rules;\r\n\t}\r\n\r\n\treturn this.compileSchemaRule(schemaType);\r\n};\r\n\r\nValidator.prototype.compileSchemaRule = function(schemaRule) {\r\n\tif (typeof schemaRule === \"string\") {\r\n\t\tschemaRule = {\r\n\t\t\ttype: schemaRule\r\n\t\t};\r\n\t}\r\n\r\n\tconst ruleFunction = this.rules[schemaRule.type];\r\n\tif (!ruleFunction) {\r\n\t\tthrow new Error(\"Invalid '\" + schemaRule.type + \"' type in validator schema!\");\r\n\t}\r\n\r\n\tlet dataParameter = null;\r\n\tlet dataFunction = null;\r\n\r\n\tif (schemaRule.type === \"object\" && schemaRule.props) {\r\n\t\tdataParameter = this.compileSchemaObject(schemaRule.props);\r\n\t\tdataFunction = this.checkSchemaObject;\r\n\t} else if (schemaRule.type === \"array\" && schemaRule.items) {\r\n\t\tdataParameter = this.compileSchemaType(schemaRule.items);\r\n\t\tdataFunction = this.checkSchemaArray;\r\n\t}\r\n\r\n\treturn {\r\n\t\tschemaRule: schemaRule,\r\n\t\truleFunction: ruleFunction,\r\n\t\tdataFunction: dataFunction,\r\n\t\tdataParameter: dataParameter\r\n\t};\r\n};\r\n\r\nValidator.prototype.checkSchemaObject = function(value, compiledObject, path, parent) {\r\n\tif (compiledObject.cycle) {\r\n\t\tif (compiledObject.objectStack.indexOf(value) !== -1) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tcompiledObject.objectStack.push(value);\r\n\t\tconst result = this.checkSchemaObjectInner(value, compiledObject, path, parent);\r\n\t\tcompiledObject.objectStack.pop();\r\n\t\treturn result;\r\n\t} else {\r\n\t\treturn this.checkSchemaObjectInner(value, compiledObject, path, parent);\r\n\t}\r\n};\r\n\r\nValidator.prototype.checkSchemaObjectInner = function(value, compiledObject, path, parent) {\r\n\treturn compiledObject.compiledObjectFunction.call(this, value, compiledObject.properties, path, parent);\r\n\r\n\t/*\r\n\t// Reference implementation of the object checker\r\n\r\n\tconst errors = [];\r\n\tconst propertiesLength = compiledObject.properties.length;\r\n\tfor (let i = 0; i < propertiesLength; i++) {\r\n\t\tconst property = compiledObject.properties[i];\r\n\t\tconst propertyPath = (path !== undefined ? path + \".\" : \"\") + property.name;\r\n\t\tconst res = this.checkSchemaType(value[property.name], property.compiledType, propertyPath, value);\r\n\r\n\t\tif (res !== true) {\r\n\t\t\tthis.handleResult(errors, propertyPath, res);\r\n\t\t}\r\n\t}\r\n\r\n\treturn errors.length === 0 ? true : errors;\r\n\t*/\r\n};\r\n\r\nValidator.prototype.checkSchemaType = function(value, compiledType, path, parent) {\r\n\tif (Array.isArray(compiledType)) {\r\n\t\tconst errors = [];\r\n\t\tconst checksLength = compiledType.length;\r\n\t\tfor (let i = 0; i < checksLength; i++) {\r\n\t\t\t// Always compiled to list of rules\r\n\t\t\tconst res = this.checkSchemaRule(value, compiledType[i], path, parent);\r\n\r\n\t\t\tif (res !== true) {\r\n\t\t\t\tthis.handleResult(errors, path, res);\r\n\t\t\t} else {\r\n\t\t\t\t// Jump out after first success and clear previous errors\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn errors;\r\n\t} \r\n\r\n\treturn this.checkSchemaRule(value, compiledType, path, parent);\r\n};\r\n\r\nValidator.prototype.checkSchemaArray = function(value, compiledArray, path, parent) {\r\n\tconst errors = [];\r\n\tconst valueLength = value.length;\r\n\r\n\tfor (let i = 0; i < valueLength; i++) {\r\n\t\tconst itemPath = (path !== undefined ? path : \"\") + \"[\" + i + \"]\";\r\n\t\tconst res = this.checkSchemaType(value[i], compiledArray, itemPath, value, parent);\r\n\r\n\t\tif (res !== true) {\r\n\t\t\tthis.handleResult(errors, itemPath, res);\r\n\t\t}\r\n\t}\r\n\r\n\treturn errors.length === 0 ? true : errors;\r\n};\r\n\r\nValidator.prototype.checkSchemaRule = function(value, compiledRule, path, parent) {\r\n\tconst schemaRule = compiledRule.schemaRule;\r\n\r\n\tif (value === undefined || value === null) {\r\n\t\tif (schemaRule.type === \"forbidden\")\r\n\t\t\treturn true;\r\n\r\n\t\tif (schemaRule.optional === true)\r\n\t\t\treturn true;\r\n\r\n\t\tconst errors = [];\r\n\t\tthis.handleResult(errors, path, this.makeError(\"required\"));\r\n\t\treturn errors;\r\n\t}\r\n\r\n\tconst res = compiledRule.ruleFunction.call(this, value, schemaRule, path, parent);\r\n\tif (res !== true) {\r\n\t\tconst errors = [];\r\n\t\tthis.handleResult(errors, path, res);\r\n\t\treturn errors;\r\n\t}\r\n\r\n\tif (compiledRule.dataFunction !== null) {\r\n\t\treturn compiledRule.dataFunction.call(this, value, compiledRule.dataParameter, path, parent);\r\n\t}\r\n\r\n\treturn true;\r\n};\r\n\r\n/**\r\n * Handle results from validator functions\r\n *\r\n * @param {Array} errors\r\n * @param {String} fieldPath\r\n * @param {Array|Object} res\r\n */\r\nValidator.prototype.handleResult = function(errors, fieldPath, res) {\r\n\tlet items;\r\n\tif (!Array.isArray(res))\r\n\t\titems = [res];\r\n\telse\r\n\t\titems = res;\r\n\r\n\titems.forEach(err => {\r\n\t\tif (!err.field)\r\n\t\t\terr.field = fieldPath;\r\n\t\tif (!err.message)\r\n\t\t\terr.message = this.resolveMessage(err);\r\n\r\n\t\terrors.push(err);\r\n\t});\r\n};\r\n\r\n/**\r\n * Create a validation error object\r\n *\r\n * @param {String} type\r\n * @param {Any} expected\r\n * @param {Any} actual\r\n */\r\nValidator.prototype.makeError = function(type, expected, actual) {\r\n\treturn {\r\n\t\ttype: type,\r\n\t\texpected: expected,\r\n\t\tactual: actual\r\n\t};\r\n};\r\n\r\n/**\r\n * Resolve message string from a validation error object\r\n *\r\n * @param {Object} err Validation error object\r\n */\r\nValidator.prototype.resolveMessage = function(err) {\r\n\tlet msg = this.messages[err.type];\r\n\tif (msg != null) {\r\n\t\tconst expected = err.expected != null ? err.expected : \"\";\r\n\t\tconst actual = err.actual != null ? err.actual : \"\";\r\n\t\treturn msg.replace(/\\{field\\}/g, err.field).replace(/\\{expected\\}/g, expected).replace(/\\{actual\\}/g, actual);\r\n\t}\r\n};\r\n\r\n/**\r\n * Add a custom validator rule\r\n *\r\n * @param {String} type\r\n * @param {Function} fn\r\n */\r\nValidator.prototype.add = function(type, fn) {\r\n\tthis.rules[type] = fn;\r\n};\r\n\r\nmodule.exports = Validator;\r\n","module.exports = require(\"./lib/validator.js\");"],"names":["const","let","require$$0","require$$1","require$$2","require$$3","require$$4","require$$5","require$$6","require$$7","require$$8","require$$9","require$$10","require$$11","require$$12","defaultMessages","deepExtend","this","flatten","errors"],"mappings":"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"}